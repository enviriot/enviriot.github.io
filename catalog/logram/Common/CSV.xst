<?xml version='1.0' encoding='utf-8' standalone='yes'?>
<xst path='/$YS/TYPES/LoBlock/Common' m='{"attr":65}' >
  <i n='CSV' s='{"cctor":{"LoBlock":"Common/CSV"},"Children":{"A":{"default":0,"ddr":-1,"manifest":{"attr":69},"rc":"X1"},"B":{"ddr":-2,"default":0,"manifest":{"attr":68},"rc":"X2"},"C":{"default":0,"ddr":-3,"manifest":{"attr":68},"rc":"X3"},"D":{"default":0,"ddr":-4,"manifest":{"attr":68},"rc":"X4"},"E":{"default":0,"ddr":-5,"manifest":{"attr":68},"rc":"X5"},"F":{"default":0,"ddr":-6,"manifest":{"attr":68},"rc":"X6"},"G":{"default":0,"ddr":-7,"manifest":{"attr":68},"rc":"X7"},"H":{"default":0,"ddr":-8,"manifest":{"attr":68},"rc":"X8"},"path":{"default":"out/data.csv","manifest":{"attr":69}}},"default":"","hint":"Export to CSV","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJUExURdz//wAm/wAAAFWpy24AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAxSURBVBjTY8ADBAUFGBgYBQVBDCYFEIOBEcQAijKACMIMuGIIA2SgAsxAsMlogIEBAML6Au28tFxGAAAAAElFTkSuQmCC","manifest":{"attr":66,"type":"LoBlock/Common/CSV"},"namePrefix":"A","src":"class CSV{\r\n  constructor(){\r\n    this.tm1 = null;\r\n    this.inputs=[\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"];\r\n  }\r\n  Calculate(pin){\r\n    let act = false;\r\n    let i;\r\n    for(i=0; i&lt;this.inputs.length; i++){\r\n      if(pin == this.inputs[i]){\r\n        act = true;\r\n        break;\r\n      }\r\n    }\r\n    if(act &amp;&amp; this.tm1==null){\r\n      this.tm1 = setTimeout(this.Export.bind(this), 16);\r\n    }\r\n  }\r\n  Export(){\r\n    clearTimeout(this.tm1);\r\n    this.tm1 = null;\r\n    let now = new Date();\r\n    let txt = now.getFullYear() + &apos;.&apos; + this.Pad(now.getMonth() + 1) + &apos;.&apos; + this.Pad(now.getDate()) +\r\n        &apos; &apos; + this.Pad(now.getHours()) + &apos;:&apos; + this.Pad(now.getMinutes()) + &apos;:&apos; + this.Pad(now.getSeconds()) + &apos;.&apos; + (now.getMilliseconds() / 1000).toFixed(3).slice(2, 5);\r\n\r\n    let v, i;\r\n    for(i=0; i&lt;this.inputs.length; i++){\r\n      v = this.GetState(this.inputs[i]);\r\n      if(typeof(v)==\"number\"){\r\n        txt += \";\";\r\n        txt += v.toString();\r\n      }\r\n    }\r\n    txt += \"\\r\\n\";\r\n    File.AppendText(this.GetState(\"path\"), txt);\r\n  }\r\n  Pad(number) {\r\n    if(number &lt; 10){\r\n      return &apos;0&apos; + number;\r\n    }\r\n    return number;\r\n  }\r\n}","willful":true}' m='{"attr":69,"type":"Ext/LBDescr"}' ver='0.4.2009.23001' />
</xst>