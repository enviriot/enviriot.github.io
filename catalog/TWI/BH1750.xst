<?xml version='1.0' encoding='utf-8' standalone='yes'?>
<xst path='/$YS/TYPES/TWI'>
  <i n='BH1750' s='{"Children":{},"hint":"Ambient Light Sensor","default":0,"editor":"Enum","enum":"TwiStatus","manifest":{"MQTT-SN":{"tag":"---"},"type":"TWI/BH1750","TWI":{"addr":0}},"mi":{"TWI":{"attr":1,"mi":{"addr":{"attr":1,"default":1,"type":"Integer"}}}},"src":"class BH1750{\r\n  constructor(){\r\n    setTimeout(this.Tick.bind(this), 500*(1+Math.random()));\r\n  }\r\n  Read(){\r\n    var addr=this.GetField(null,\"TWI.addr\")==0?0x23:0x5C;\r\n    this.TwiReq([addr, 0x02, 0x00, 0x02])\r\n      .then(r =&gt; {\r\n        this.SetState(null,1);\r\n        this.SetState(\"I\",Math.round((r[4]*256 + r[5])/1.2));\r\n        setTimeout(this.Tick.bind(this), 60000);\r\n      },\r\n      e=&gt;{\r\n        this.SetState(null,0);\r\n        setTimeout(this.Tick.bind(this), 60000*(1+Math.random()));\r\n    });\r\n  }\r\n  Tick(){\r\n    var addr=this.GetField(null,\"TWI.addr\")==0?0x23:0x5C;\r\n    this.TwiReq([addr, 0x01, 0x01, 0x00, 0x23]);  // One time L-resolution mode\r\n    setTimeout(this.Read.bind(this), 50);  \r\n  }\r\n}\r\n"}' m='{"attr":69,"type":"Ext/TwiDev"}' ver='0.4.1907.16000' />
</xst>